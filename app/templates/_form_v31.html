<!-- templates/_form_v31.html -->
<div id="form-v31" class="calculator-form">
    {# A linha {% set ... %} foi removida. A variável 'metrics' agora vem do include. #}
    <h2 class="text-2xl font-bold text-gray-900 mb-4">Métricas CVSS 3.1</h2>
    
    <!-- Base Metrics -->
    <h3 class="text-lg font-semibold text-gray-900">Métricas de Base</h3>
    <div class="metric-group !mt-4 !pt-4 border-t border-gray-200">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div><label class="block text-sm font-medium">Vetor de Ataque (AV)</label><select name="v31_AV" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="N" {% if metrics.AV == 'N' %}selected{% endif %}>Rede</option><option value="A" {% if metrics.AV == 'A' %}selected{% endif %}>Adjacente</option><option value="L" {% if metrics.AV == 'L' %}selected{% endif %}>Local</option><option value="P" {% if metrics.AV == 'P' %}selected{% endif %}>Físico</option></select></div>
            <div><label class="block text-sm font-medium">Complexidade (AC)</label><select name="v31_AC" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="L" {% if metrics.AC == 'L' %}selected{% endif %}>Baixa</option><option value="H" {% if metrics.AC == 'H' %}selected{% endif %}>Alta</option></select></div>
            <div><label class="block text-sm font-medium">Privilégios (PR)</label><select name="v31_PR" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="N" {% if metrics.PR == 'N' %}selected{% endif %}>Nenhum</option><option value="L" {% if metrics.PR == 'L' %}selected{% endif %}>Baixo</option><option value="H" {% if metrics.PR == 'H' %}selected{% endif %}>Alto</option></select></div>
            <div><label class="block text-sm font-medium">Interação (UI)</label><select name="v31_UI" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="N" {% if metrics.UI == 'N' %}selected{% endif %}>Nenhuma</option><option value="R" {% if metrics.UI == 'R' %}selected{% endif %}>Requerida</option></select></div>
            <div><label class="block text-sm font-medium">Escopo (S)</label><select name="v31_S" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="U" {% if metrics.S == 'U' %}selected{% endif %}>Inalterado</option><option value="C" {% if metrics.S == 'C' %}selected{% endif %}>Alterado</option></select></div>
            <div><label class="block text-sm font-medium">Confidencialidade (C)</label><select name="v31_C" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="H" {% if metrics.C == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.C == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.C == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
            <div><label class="block text-sm font-medium">Integridade (I)</label><select name="v31_I" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="H" {% if metrics.I == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.I == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.I == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
            <div><label class="block text-sm font-medium">Disponibilidade (A)</label><select name="v31_A" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="H" {% if metrics.A == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.A == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.A == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
        </div>
    </div>

    <!-- Temporal Metrics -->
    <h3 class="text-lg font-semibold text-gray-900 mt-6">Métricas Temporais</h3>
    <div class="metric-group !mt-4 !pt-4 border-t border-gray-200">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div><label class="block text-sm font-medium">Maturidade do Exploit (E)</label><select name="v31_E" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.E or metrics.E == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.E == 'H' %}selected{% endif %}>Alta</option><option value="F" {% if metrics.E == 'F' %}selected{% endif %}>Funcional</option><option value="P" {% if metrics.E == 'P' %}selected{% endif %}>Prova de Conceito</option><option value="U" {% if metrics.E == 'U' %}selected{% endif %}>Não Provado</option></select></div>
            <div><label class="block text-sm font-medium">Nível de Correção (RL)</label><select name="v31_RL" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.RL or metrics.RL == 'X' %}selected{% endif %}>Não Definido</option><option value="O" {% if metrics.RL == 'O' %}selected{% endif %}>Oficial</option><option value="T" {% if metrics.RL == 'T' %}selected{% endif %}>Temporária</option><option value="W" {% if metrics.RL == 'W' %}selected{% endif %}>Workaround</option><option value="U" {% if metrics.RL == 'U' %}selected{% endif %}>Indisponível</option></select></div>
            <div><label class="block text-sm font-medium">Conf. do Relatório (RC)</label><select name="v31_RC" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.RC or metrics.RC == 'X' %}selected{% endif %}>Não Definido</option><option value="C" {% if metrics.RC == 'C' %}selected{% endif %}>Confirmado</option><option value="R" {% if metrics.RC == 'R' %}selected{% endif %}>Razoável</option><option value="U" {% if metrics.RC == 'U' %}selected{% endif %}>Desconhecido</option></select></div>
        </div>
    </div>

    <!-- Environmental Metrics -->
    <h3 class="text-lg font-semibold text-gray-900 mt-6">Métricas Ambientais</h3>
    <div class="metric-group !mt-4 !pt-4 border-t border-gray-200">
        <h4 class="text-md font-semibold text-gray-700">Requisitos de Segurança</h4>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
            <div><label class="block text-sm font-medium">Confidencialidade (CR)</label><select name="v31_CR" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.CR or metrics.CR == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.CR == 'H' %}selected{% endif %}>Alto</option><option value="M" {% if metrics.CR == 'M' %}selected{% endif %}>Médio</option><option value="L" {% if metrics.CR == 'L' %}selected{% endif %}>Baixo</option></select></div>
            <div><label class="block text-sm font-medium">Integridade (IR)</label><select name="v31_IR" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.IR or metrics.IR == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.IR == 'H' %}selected{% endif %}>Alto</option><option value="M" {% if metrics.IR == 'M' %}selected{% endif %}>Médio</option><option value="L" {% if metrics.IR == 'L' %}selected{% endif %}>Baixo</option></select></div>
            <div><label class="block text-sm font-medium">Disponibilidade (AR)</label><select name="v31_AR" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.AR or metrics.AR == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.AR == 'H' %}selected{% endif %}>Alto</option><option value="M" {% if metrics.AR == 'M' %}selected{% endif %}>Médio</option><option value="L" {% if metrics.AR == 'L' %}selected{% endif %}>Baixo</option></select></div>
        </div>
    </div>
    <div class="metric-group">
        <h4 class="text-md font-semibold text-gray-700">Métricas de Base Modificadas</h4>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
            <div><label class="block text-sm font-medium">AV Modificado (MAV)</label><select name="v31_MAV" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MAV or metrics.MAV == 'X' %}selected{% endif %}>Não Definido</option><option value="N" {% if metrics.MAV == 'N' %}selected{% endif %}>Rede</option><option value="A" {% if metrics.MAV == 'A' %}selected{% endif %}>Adjacente</option><option value="L" {% if metrics.MAV == 'L' %}selected{% endif %}>Local</option><option value="P" {% if metrics.MAV == 'P' %}selected{% endif %}>Físico</option></select></div>
            <div><label class="block text-sm font-medium">AC Modificado (MAC)</label><select name="v31_MAC" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MAC or metrics.MAC == 'X' %}selected{% endif %}>Não Definido</option><option value="L" {% if metrics.MAC == 'L' %}selected{% endif %}>Baixa</option><option value="H" {% if metrics.MAC == 'H' %}selected{% endif %}>Alta</option></select></div>
            <div><label class="block text-sm font-medium">PR Modificado (MPR)</label><select name="v31_MPR" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MPR or metrics.MPR == 'X' %}selected{% endif %}>Não Definido</option><option value="N" {% if metrics.MPR == 'N' %}selected{% endif %}>Nenhum</option><option value="L" {% if metrics.MPR == 'L' %}selected{% endif %}>Baixo</option><option value="H" {% if metrics.MPR == 'H' %}selected{% endif %}>Alto</option></select></div>
            <div><label class="block text-sm font-medium">UI Modificado (MUI)</label><select name="v31_MUI" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MUI or metrics.MUI == 'X' %}selected{% endif %}>Não Definido</option><option value="N" {% if metrics.MUI == 'N' %}selected{% endif %}>Nenhuma</option><option value="R" {% if metrics.MUI == 'R' %}selected{% endif %}>Requerida</option></select></div>
            <div><label class="block text-sm font-medium">Escopo Modificado (MS)</label><select name="v31_MS" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MS or metrics.MS == 'X' %}selected{% endif %}>Não Definido</option><option value="U" {% if metrics.MS == 'U' %}selected{% endif %}>Inalterado</option><option value="C" {% if metrics.MS == 'C' %}selected{% endif %}>Alterado</option></select></div>
            <div><label class="block text-sm font-medium">Conf. Modificada (MC)</label><select name="v31_MC" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MC or metrics.MC == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.MC == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.MC == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.MC == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
            <div><label class="block text-sm font-medium">Int. Modificada (MI)</label><select name="v31_MI" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MI or metrics.MI == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.MI == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.MI == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.MI == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
            <div><label class="block text-sm font-medium">Disp. Modificada (MA)</label><select name="v31_MA" class="mt-1 w-full rounded-md border-gray-300 shadow-sm"><option value="X" {% if not metrics.MA or metrics.MA == 'X' %}selected{% endif %}>Não Definido</option><option value="H" {% if metrics.MA == 'H' %}selected{% endif %}>Alta</option><option value="L" {% if metrics.MA == 'L' %}selected{% endif %}>Baixa</option><option value="N" {% if metrics.MA == 'N' %}selected{% endif %}>Nenhuma</option></select></div>
        </div>
    </div>
</div>
